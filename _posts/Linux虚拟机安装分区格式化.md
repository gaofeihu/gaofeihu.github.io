## Linux安装分区格式化

`32位的centeros`

> 32位的centerOS最大识别3.1G的内存

`资源分配` 

> | CPU  | **建议主频1GHZ以上** |
> | ---- | -------------------- |
> | 内存 | 建议1GB以上          |
> | 硬盘 | 建议8GB以上          |
>
> CenterOS安装至少需要628M内存，否则会开启简易安装。

`虚拟机网络设置`

| 链接方式 | 链接网卡 | 🔗宿主机 | 🔗局域网 | 🔗公网 |
| -------- | -------- | ------- | ------- | :---: |
| 桥接     | 真实网卡 | ✅       | ✅       |   ✅   |
| NAT      | VMnet8   | ✅       | ❌       |   ✅   |
| 仅主机   | VMnet1   | ✅       | ❌       |   ❌   |

`桥接网卡自动`

> 如果宿主机是网线连接则选择Killer...
>
> 如果宿主机是无限网连接则选择Inter..
>
> 在宿主机器的网卡选项中会用显示

`磁盘分区`

> 硬盘分区，是指将硬盘的整体存储空间划分成多个独立的区域，分别用于操作系统、应用程序以及数据文件等。
>
> 硬盘分区是指在一块物理硬盘上创建多个独立的逻辑单元，以方便文件管理与使用，这些逻辑单元就是所谓的C盘、D盘、E盘等。硬盘分区从实质上说就是对硬盘的一种格式化。

`两种分区表`

> - MBR 分区表 ： 最大支持2.1TB硬盘，最多支持4个分区。
> - GPT分区表（全局唯一标示分区表）：GPR支持9.4ZB硬盘，理论上分区数没有限制，但windows限制128个
> - 1ZB = 1024PB 1PB = 1024EB 1EB=1024TB
> - 分区的目的主要是方便数据管理。

`分区类型`

- 主分区：最多只能有4个编号-14是给主分区用的
- 扩展分区：
  - 最多只能有1个
  - 主分区+扩展分区最多有4个
  - 不能写入数据数据，只能包含逻辑分区
- 逻辑分区

`格式化是什么`

格式化（高级格式化）又称逻辑格式化，他是根据用户选定的文件系统,在磁盘特定的区域写入特定的数据，在分区中划出一片空间用于存放文件分配表，目录等用于文件管理的磁盘空间

windows ： FAT16	FAT32	NTFS

Linux：		EXT2	  EXT3	  EXT4

 

>格式化是为了写入文件系统，格式化会覆盖数据并写入文件系统。简单理解格式化就是将硬盘分为两个区域。
>
>- 索引区（inode）
>
>  - 每个文件都有Inode号，inode的大小是128b,里面存储了i节点号，变动时间，权限，和存储的block位置等信息。
>  - 后台不允许存储空文件，因为这样也有可能将磁盘Inode区域写满，从而造成存储失败的情况。
>
>- 数据区（data）
>
>  数据区分为无数个block,block是存储文件的最小单位。它是无序的， block的大小可以是4、2、1kb，默认是4kb,当一个block没有被写满，则剩余空间不能存储其他文件。

`硬件设备文件名`



`挂载`

> 把设备（/dev/sdb）和空目录连接起来，就叫做挂载。相当于给设备分配盘符。

- 必须分区
  - /(根分区)
  - swap分区 （交换分区）
    - 如果真实内存小于4GB、swap为内存的两倍。
    - 如果真实内存大于4GB、 swap大小和内存一致。
    - 实验环境，不大于2GB
- 推荐分区(必须分区)
  - /boot（启动分区 1GB）boot分区是开机时系统会释放几十M的文件，boot分区不要和/为同一个分区，否则/根分区写满以后，会导致无法开机。
- 常用分区
  - /home	文件服务器
  - /www    web服务器

### 安装过程

 1. 选择语言 ——>中文安装

 2. 选择键盘 ——> 标准美式键盘

 3. 基础存储设备

 4. 主机名   ——> 再生产环境建议根据业务场景修改主机名，初学者建议不要修改。

 5. 时区  ——>   上海时间/北京时间（centerOS7以上）

 6. 设置root密码   ——>  

    >  	1. 复杂性：
    >       	1. 密码长度大于8位
    >       	2. 大写字母、小写字母、数字、符号、最少包含三种
    >       	3. 不允许使用和个人信息相关的内容。
    >       	4. 不允许使用现有的英语单词
    >  	2. 易记原则
    >       	1.  Flzx_3QC
    >  	3. 时效性 180天

 7. 创建自定义布局

     	1. /boot 200M足够
     	2. /swap 内存两倍
     	3. /home 2GB
     	4. /          剩余空间
     	5. 格式化并将修改写入磁盘

 8. 最小化（minimal） 或者 基础服务 Basic Server

`ip配置`

>  setup
>
> Network configuration
>
> Device configuration
>
> eth 0
>
> 配置解释
>
> ​		use DHCP [*] *代表自动获取IP
>
> ​		onboot  [*]    启动网卡  注意不要将\*设置为空，否则不回启动该网卡。\* = yes
>
> ​		lo local localbak 127.0.0.1

`日志文件`

> anaconda-ks.cfg  安装的配置信息，可以用于批量安装
>
> install.log  	当前安装软件包的日志
>
> install.log.syslog 安装过程中数据的日志

`目录结构`/

| 目录名            | 作用                                                         |
| ----------------- | ------------------------------------------------------------ |
| /bin/             | 存放系统命令的目录，普通用户和超级管理员用户都可以执行，是/usr/bin目录的软连接 |
| /sbin/            | 存放系统的命令，只有超级用户才可以执行，是/usr/bin的软连接   |
| /usr/bin/         | 存放系统命令的目录，普通用户和超级用户可以执行               |
| /usr/sbin/        | 存放系统命令的目录，只有超级用户才可以执行                   |
| /boot/            | 系统启动目录，保存于启动相关的文件，如内核文件和启动引导程序（grub）文件等 |
| /dev/             | 设备文件的保存位置                                           |
| /etc/             | 配置文件保存位置，系统内所有采用默认安装方式（rpm安装）的服务配置文件，全保存在此目录，如用户信息，服务的启动脚本，常用服务的配置文件等。 |
| /home/            | 普通用户的家目录。                                           |
| /root/            | root用户的家目录                                             |
| /lib/             | 系统调用函数的保存位置，是/usr/lib的软连接                   |
| /lib64/           | 64位函数的保存位置，是/usr/lib的软连接。<br /> *.so.number 是Linux重要的系统函数 |
| /lost+found/      | 当系统以外崩溃或者关机，而产生一些文件碎片在这里，当系统启动过程中fsck工具会检查这里，并修复已经损坏的文件系统，这个目录只在每个分区中出现，例如/lost+found 就是根分区的备份恢复目录，/boot/lost+found 就是/boot分区的备份恢复目录。开机时自动执行修复，如果能修复就修复，手工执行没有毛用。 |
| /media/           | 挂载目录，系统建议用来挂载媒体设备的，如软盘和光盘           |
| /misc/            | 挂载目录,系统建议用来挂载（网络存储设备）nfs的目录，我们在刚刚已经解释了挂载，应该知道是一个已经建立的空目录就可以作为挂载点，虽然系统准备了三个挂载目录，但是到底在哪个目录中挂载什么设备可以由管理员决定。早起只有/mnt/例如 /mnt/cdrom 挂载光盘 /mnt/usb 挂载U盘 |
| /mnt/             | 挂载目录，早期Linux只有这一个挂载目录，并没有细分，现在这个目录用来挂载额外的设备，如U盘、移动硬盘、和其他操作系统的分区。工程师不习惯用其他两个目录。 |
| /opt/             | c6才出现，第三方软件的安装的位置。这个目录是放置和安装其他软件的位置，手动安装的源码包软件都可以安装到这个目录中，但老的工程师还是习惯 /usr/local 目录安装。也可以。例如 /usr/local/(mysql/apache) |
| /proc /           | 虚拟文件系统，该目录的数据并不保存在硬盘上，而是保存到**内存中**，主要保存系统的内核、进程、外部设备状态和网络状态等，如/proc/cpuinfo 保存的是CPU信息，/proc/devices 是保存设备驱动的列表的，/proc/fileSystems 是保存文件系统列表的，/proc/net 是保存网络协议的。 |
| /net/             | 内存挂载点                                                   |
| /sys/             | 内存挂载点，虚拟文件系统，与/proc/目录相似，该目录中的数据都保存在内存中，主要保存与内核相关的信息。 |
| /selinux/         | linux安装增强组件的保存位置。是美国国家安全局牵头开发的，用来限制root的权限。 |
| /usr/             | Unix software Resource 的缩写，所以存放的不是用户的数据，而是存放系统软件资源的目录，系统中安装的软件大多数保存在这里。 |
| /usr/lib/         | 应用程序吊桶的函数保存位置                                   |
| /usr/local/       | 手工安装软件的位置。我们一般建议把源码包保存到这个位置。/usr/local/java/ |
| /usr/share/       | 应用程序的资源文件保存位置，如帮助文档、说明文档和字体目录。 |
| /usr/src          | 源码包保存位置，我们手工下载的源码包和内核源码包都可以保存到这里，不过我们更习惯把手工下载的源码包保存到/usr/loacal/src下面。把内核源码包保存到/usr/src/kernels/目录中 |
| /usr/src/kernels/ | 内核源码保存位置                                             |
| /var/             | 保存动态数据的位置，主要是缓存、日志以及软件运行时所产生的文件。 |
| /var/www/html/    | RPM包安装的Apache的网页主目录，安装apache之后才会有。        |
| /var/lib/         | 程序运行中需要调用或改变的数据保存位置，如mysql的数据库保存在/var/lib/mysql目录中。 |
| /var/log/         | 系统日志的保存位置。                                         |
| /var/run/         | 一些服务和程序运行后，它们的pid（进程id）保存位置，是/run/目录的软连接。 |
| /var/spool/       | 放置队列数据的目录，就是排队等待其他的程序使用的数据，比如邮件队列和打印队列。 |
| /var/spool/mail/  | 收到的邮件队列保存位置。系统新收到的邮件会保存在此目录中。   |
| /var/spool/cron/  | 系统的定时任务队列保存位置，系统的计划任务会保存到这里。     |
| /run/             | 系统运行时产生的数据，如ssid,pid等相关数据。/var/run是此目录的软连接。 |
| /tmp/             | 临时目录                                                     |



自己测试位置 ~  或者 /tmp

⚠️注意事项：

- 远程服务器不能关机，只能重启。

- 在远程服务重启前，要终止正在执行的服务。否则有可能造成硬盘损坏。小心驶得万年船～

- 重启命令推荐 shutdown -r now，在重启之前执行几次 sync命令。

- 不要在服务器访问高峰运行高负载命令。

- 17 - 24  点为访问高峰。4点-5点为执行命令期间。

- 配置防火墙不要把自己踢出服务器。

  - 防火墙：基本功能是数据包过滤

    - IP
    - Mac地址
    - 端口号
    - 协议
    - 数据包过滤

    > 写一个定时任务，5分钟清空防火墙。等测试没问题再删除这个系统定时任务。

- 指定密码规范并定期更新。

- 合理分配权限

  - 简单原则，给予用户最小的权限。

- 定期备份重要数据和日志

  - 不要把🥚放到一个🧺子里。

**配置 IP 地址** 

##### 1.1 配置IP地址 

IP 地址是计算机在互联网中唯一的地址编码。每台计算机如果需要接入网络和其他计算机进行数 据通信，就必须配置唯一的公网 IP 地址。 

配置 IP 地址有两种方法:
 1)setup 工具
 2)vi /etc/sysconfig/network-scripts/ifcfg-eth0 手工修改配置文件 

##### 1.2 重启网络服务 

``` bash
[root@localhost ~]# service network restart #重启网络服务 
```

##### 1.3 虚拟机需要桥接到有线网卡，并重启网络服务 

##### 1.4 复制镜像有可能需要重置UUID(唯一识别符 ）

```bash
[root@localhost ~]# vi /etc/sysconfig/network-scripts/ifcfg-eth0 
#删除 MAC 地址行
[root@localhost ~]# rm -rf /etc/udev/rules.d/70-persistent-net.rules
#删除 MaC 地址和 UUID 绑定文件
[root@localhost ~]# reboot 
#重启 Linux
```

